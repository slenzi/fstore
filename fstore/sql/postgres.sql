drop sequence TEST.FS_NODE_ID_SEQUENCE;
drop sequence TEST.FS_LINK_ID_SEQUENCE;	
drop sequence TEST.FS_PRUNE_ID_SEQUENCE;
drop sequence TEST.FS_TREE_ID_SEQUENCE;

drop sequence TEST.FS_CMS_FILE_ID_SEQUENCE;
drop sequence TEST.FS_CMS_FILE_STORE_ID_SEQUENCE;

drop index TEST.fs_parent_depth_child_idx;
drop index TEST.fs_child_parent_depth_idx;	

drop table TEST.FS_NODE;
drop table TEST.FS_CLOSURE;	
drop table TEST.FS_PRUNE;
drop table TEST.FS_TREE;

drop table TEST.FS_TEST_NODE;

drop table TEST.FS_CMS_FILE;
drop table TEST.FS_CMS_FILE_ENTRY;
drop table TEST.FS_CMS_DIRECTORY;
drop table TEST.FS_CMS_DIR_FILE_LINK;
drop table TEST.FS_CMS_FILE_STORE;

create table TEST.FS_NODE ( 
	NODE_ID NUMERIC(15,0) NOT NULL, 
	PARENT_NODE_ID NUMERIC(15,0) NOT NULL, 
	NODE_TYPE CHARACTER VARYING(100) NOT NULL, 
	NAME CHARACTER VARYING(250) NOT NULL, 
	CREATION_DATE TIMESTAMP NOT NULL, 
	UPDATED_DATE TIMESTAMP NOT NULL, 
	PRIMARY KEY (NODE_ID) 
);

create table TEST.FS_CLOSURE ( 
	LINK_ID NUMERIC(15,0) NOT NULL, 
	PARENT_NODE_ID NUMERIC(15,0) NOT NULL, 
	CHILD_NODE_ID NUMERIC(15,0) NOT NULL, 
	DEPTH NUMERIC(5,0) NOT NULL, 
	PRIMARY KEY (LINK_ID) 
);

create table TEST.FS_PRUNE ( 
	PRUNE_ID NUMERIC(15,0) NOT NULL, 
	NODE_ID NUMERIC(15,0) NOT NULL, 
	PRIMARY KEY (PRUNE_ID,NODE_ID) 
);

create table TEST.FS_TREE ( 
	TREE_ID NUMERIC(15,0) NOT NULL, 
	ROOT_NODE_ID NUMERIC(15,0) NOT NULL, 
	NAME CHARACTER VARYING(250) NOT NULL, 
	DESCRIPTION CHARACTER VARYING(2000), 
	CREATION_DATE TIMESTAMP NOT NULL, 
	UPDATED_DATE TIMESTAMP NOT NULL, 
	PRIMARY KEY (TREE_ID) 
);

/* test node table */
create table TEST.FS_TEST_NODE ( 
	NODE_ID NUMERIC(15,0) NOT NULL, 
	TEST_VALUE CHARACTER VARYING(250), 
	PRIMARY KEY (NODE_ID) 
);

/* example node for modeling a directory */
create table TEST.FS_CMS_DIRECTORY ( 
	NODE_ID NUMERIC(15,0) NOT NULL, 
	DIR_NAME CHARACTER VARYING(250),  
	PRIMARY KEY (NODE_ID) 
);

/* link file to directory */
create table TEST.FS_CMS_DIR_FILE_LINK (
	NODE_ID NUMERIC(15,0) NOT NULL,
	FILE_ID NUMERIC(15,0) NOT NULL,
	PRIMARY KEY(NODE_ID,FILE_ID)
);

/* for storing file meta */
create table TEST.FS_CMS_FILE_ENTRY ( 
	FILE_ID NUMERIC(15,0) NOT NULL,
	FILE_NAME CHARACTER VARYING(250),
	PRIMARY KEY (FILE_ID) 
);

/* for storing binary data  */
create table TEST.FS_CMS_FILE ( 
	FILE_ID NUMERIC(15,0) NOT NULL,
	FILE_DATA BYTEA NOT NULL,
	PRIMARY KEY (FILE_ID) 
);

/* list of file stores */
create table TEST.FS_CMS_FILE_STORE ( 
	STORE_ID NUMERIC(15,0) NOT NULL,
	STORE_NAME CHARACTER VARYING(250) NOT NULL,
	STORE_DESCRIPTION CHARACTER VARYING(4000) NOT NULL,
	STORE_PATH CHARACTER VARYING(2000) NOT NULL,
	NODE_ID NUMERIC(15,0) NOT NULL,
	CREATION_DATE TIMESTAMP NOT NULL, 
	UPDATED_DATE TIMESTAMP NOT NULL, 	
	PRIMARY KEY (STORE_ID) 
);

create unique index fs_parent_depth_child_idx on TEST.fs_closure(parent_node_id,depth,child_node_id);
create unique index fs_child_parent_depth_idx on TEST.fs_closure(child_node_id,parent_node_id,depth);	

CREATE SEQUENCE TEST.FS_NODE_ID_SEQUENCE  
INCREMENT BY 1 
START WITH 1 
CACHE 10  
NO CYCLE;	

CREATE SEQUENCE TEST.FS_LINK_ID_SEQUENCE  
INCREMENT BY 1 
START WITH 1 
CACHE 10  
NO CYCLE;

CREATE SEQUENCE TEST.FS_PRUNE_ID_SEQUENCE  
INCREMENT BY 1 
START WITH 1 
CACHE 10  
NO CYCLE;

CREATE SEQUENCE TEST.FS_TREE_ID_SEQUENCE  
INCREMENT BY 1 
START WITH 1 
CACHE 10  
NO CYCLE;

CREATE SEQUENCE TEST.FS_CMS_FILE_ID_SEQUENCE  
INCREMENT BY 1 
START WITH 1 
CACHE 10  
NO CYCLE;

CREATE SEQUENCE TEST.FS_CMS_FILE_STORE_ID_SEQUENCE  
INCREMENT BY 1 
START WITH 1 
CACHE 10  
NO CYCLE;